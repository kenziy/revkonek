import{b as M,r as h,u as T,j as e,H as u,L as y}from"./app-CQdR452s.js";import{A as j}from"./AuthenticatedLayout-HhmBnaNo.js";import{C as c,B as S,P as U,F as B}from"./ProgressBar-CmNWRyn6.js";import{F as E}from"./FileUpload-CHPvK9IG.js";import{F as P}from"./ArrowLeftIcon-DH5-a9EN.js";import{F as Y}from"./CheckCircleIcon-CrWjMXvP.js";import{F as O}from"./ClockIcon-fa_Gy2Ss.js";import{F as q}from"./ExclamationTriangleIcon-Yz6WaA5o.js";import{F as C}from"./SparklesIcon-B2_IIVCR.js";import"./clsx-B-dksMZM.js";import"./transition-fQBJqPoi.js";import"./use-sync-refs-TvPC7Lcg.js";import"./ThemeToggle-C9625XrB.js";import"./Footer-C1bh1EIQ.js";import"./UserGroupIcon-CBBpCl-6.js";import"./ShieldCheckIcon-DI5QGzMO.js";import"./PhotoIcon-vqosI-5a.js";const z=[{feature:"Max Members",free:"50",pro:"Unlimited"},{feature:"Rides / Month",free:"5",pro:"Unlimited"},{feature:"Pinned Posts",free:"1",pro:"Unlimited"},{feature:"Club Chat",free:!1,pro:!0},{feature:"Cover Image",free:!1,pro:!0},{feature:"Custom Theme",free:!1,pro:!0},{feature:"Analytics",free:!1,pro:!0},{feature:"Verified Badge",free:!1,pro:!0},{feature:"Members-Only Posts",free:!1,pro:!0},{feature:"Event Management",free:!1,pro:!0}];function de({club:a,settings:d,activeSubscription:i,latestSubscription:n}){const g=M().props.errors,[o,F]=h.useState(""),[f,N]=h.useState(!1),[s,m]=h.useState(null),{data:R,setData:b,post:L,processing:v,errors:_}=T({receipt:null,coupon_code:""}),D=async()=>{if(o.trim()){N(!0);try{const r=await(await fetch(route("clubs.subscription.validateCoupon",a.slug),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({coupon_code:o})})).json();m(r),r.valid&&b("coupon_code",o)}catch{m({valid:!1,error:"Failed to validate coupon."})}finally{N(!1)}}},$=t=>{t.preventDefault(),L(route("clubs.subscription.store",a.slug),{forceFormData:!0})},x=d?Number(d.yearly_price):0,k=s?.valid&&s.final_amount!=null?s.final_amount:x;if(i&&i.status==="active"){const t=new Date(i.starts_at),r=new Date(i.ends_at),l=new Date,w=Math.ceil((r.getTime()-t.getTime())/(1e3*60*60*24)),p=Math.max(0,Math.ceil((r.getTime()-l.getTime())/(1e3*60*60*24)));return e.jsxs(j,{header:`${a.name} — Subscription`,children:[e.jsx(u,{title:`${a.name} Subscription`}),e.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[e.jsxs(y,{href:route("clubs.settings",a.slug),className:"inline-flex items-center gap-1.5 text-sm text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300",children:[e.jsx(P,{className:"h-4 w-4"}),"Back to Settings"]}),e.jsxs(c,{padding:"lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 rounded-xl bg-accent-100 dark:bg-accent-900/30",children:e.jsx(Y,{className:"h-6 w-6 text-accent-600 dark:text-accent-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-secondary-900 dark:text-white",children:"Pro Active"}),e.jsx("p",{className:"text-sm text-secondary-500",children:"Your club is on the Pro plan"})]}),e.jsx(S,{variant:"success",size:"lg",className:"ml-auto",children:"Active"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mb-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-secondary-500 dark:text-secondary-400",children:"Started"}),e.jsx("p",{className:"font-medium text-secondary-900 dark:text-white",children:t.toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-secondary-500 dark:text-secondary-400",children:"Expires"}),e.jsx("p",{className:"font-medium text-secondary-900 dark:text-white",children:r.toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-secondary-500 dark:text-secondary-400",children:"Amount Paid"}),e.jsxs("p",{className:"font-medium text-secondary-900 dark:text-white",children:["₱",Number(i.amount).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-secondary-500 dark:text-secondary-400",children:"Days Remaining"}),e.jsxs("p",{className:"font-medium text-secondary-900 dark:text-white",children:[p," days"]})]})]}),e.jsx(U,{value:w-p,max:w,variant:p<30?"warning":"success",showLabel:!0,label:"Subscription Progress"})]})]})]})}if(n&&n.status==="pending_verification")return e.jsxs(j,{header:`${a.name} — Subscription`,children:[e.jsx(u,{title:`${a.name} Subscription`}),e.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[e.jsxs(y,{href:route("clubs.settings",a.slug),className:"inline-flex items-center gap-1.5 text-sm text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300",children:[e.jsx(P,{className:"h-4 w-4"}),"Back to Settings"]}),e.jsxs(c,{padding:"lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 rounded-xl bg-accent-100 dark:bg-accent-900/30",children:e.jsx(O,{className:"h-6 w-6 text-accent-600 dark:text-accent-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-secondary-900 dark:text-white",children:"Under Review"}),e.jsx("p",{className:"text-sm text-secondary-500",children:"Your payment receipt is being verified"})]}),e.jsx(S,{variant:"warning",size:"lg",className:"ml-auto",children:"Pending"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mb-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-secondary-500 dark:text-secondary-400",children:"Amount"}),e.jsxs("p",{className:"font-medium text-secondary-900 dark:text-white",children:["₱",Number(n.amount).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-secondary-500 dark:text-secondary-400",children:"Submitted"}),e.jsx("p",{className:"font-medium text-secondary-900 dark:text-white",children:new Date(n.created_at).toLocaleDateString()})]})]}),e.jsx("div",{className:"rounded-lg overflow-hidden bg-secondary-100 dark:bg-secondary-700",children:e.jsx("img",{src:`/storage/${n.receipt_path}`,alt:"Payment Receipt",className:"w-full max-h-[300px] object-contain"})})]})]})]});const A=n&&n.status==="rejected";return e.jsxs(j,{header:`${a.name} — Subscription`,children:[e.jsx(u,{title:`${a.name} Subscription`}),e.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[e.jsx("div",{className:"mb-4",children:e.jsx(y,{href:route("clubs.settings",a.slug),className:"text-sm text-primary-600 hover:text-primary-700 dark:text-primary-400",children:"← Back to Settings"})}),A&&e.jsx(c,{padding:"lg",className:"border-danger-200 dark:border-danger-800",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(B,{className:"h-6 w-6 text-danger-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-danger-600 dark:text-danger-400",children:"Previous Request Rejected"}),n.admin_note&&e.jsxs("p",{className:"text-sm text-secondary-600 dark:text-secondary-400 mt-1",children:["Reason: ",n.admin_note]}),e.jsx("p",{className:"text-sm text-secondary-500 mt-2",children:"You can submit a new request below."})]})]})}),d?e.jsxs(e.Fragment,{children:[e.jsxs(c,{padding:"lg",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[e.jsx(C,{className:"h-6 w-6 text-accent-500"}),e.jsx("h2",{className:"text-xl font-bold text-secondary-900 dark:text-white",children:"Upgrade to Pro"})]}),e.jsxs("div",{className:"flex items-baseline justify-center gap-1 mt-3",children:[s?.valid&&s.discount?e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-lg text-secondary-400 line-through",children:["₱",x.toLocaleString()]}),e.jsxs("span",{className:"text-3xl font-bold text-accent-600",children:["₱",k.toLocaleString()]})]}):e.jsxs("span",{className:"text-3xl font-bold text-accent-600",children:["₱",x.toLocaleString()]}),e.jsx("span",{className:"text-secondary-500",children:"/ year"})]}),d.description&&e.jsx("p",{className:"text-sm text-secondary-500 mt-2",children:d.description})]}),e.jsxs("div",{className:"border rounded-lg overflow-hidden divide-y divide-secondary-100 dark:divide-secondary-700 border-secondary-200 dark:border-secondary-700 mb-6",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 px-4 py-2 bg-secondary-50 dark:bg-secondary-800/50 text-xs font-medium text-secondary-500 uppercase",children:[e.jsx("span",{children:"Feature"}),e.jsx("span",{className:"text-center",children:"Free"}),e.jsx("span",{className:"text-center",children:"Pro"})]}),z.map(({feature:t,free:r,pro:l})=>e.jsxs("div",{className:"grid grid-cols-3 gap-4 px-4 py-2.5 text-sm",children:[e.jsx("span",{className:"text-secondary-700 dark:text-secondary-300",children:t}),e.jsx("span",{className:"text-center text-secondary-500",children:typeof r=="boolean"?r?"✓":"—":r}),e.jsx("span",{className:"text-center text-accent-600 font-medium",children:typeof l=="boolean"?l?"✓":"—":l})]},t))]})]}),e.jsxs(c,{padding:"lg",children:[e.jsx("h3",{className:"font-semibold text-secondary-900 dark:text-white mb-4",children:"Submit Payment"}),e.jsxs("form",{onSubmit:$,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-1",children:"Coupon Code (optional)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:o,onChange:t=>{F(t.target.value.toUpperCase()),m(null)},className:"flex-1 rounded-lg border border-secondary-300 dark:border-secondary-600 bg-white dark:bg-secondary-700 text-secondary-900 dark:text-white text-sm px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 font-mono",placeholder:"Enter coupon code"}),e.jsx("button",{type:"button",onClick:D,disabled:f||!o.trim(),className:"px-4 py-2 text-sm font-medium text-primary-600 bg-primary-50 rounded-lg hover:bg-primary-100 dark:bg-primary-900/20 dark:text-primary-400 transition-colors disabled:opacity-50",children:f?"Checking...":"Apply"})]}),s&&e.jsx("p",{className:`text-sm mt-1 ${s.valid?"text-success-600":"text-danger-600"}`,children:s.valid?`Discount applied! You save ₱${s.discount?.toLocaleString()}`:s.error})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-1",children:["Payment Receipt ",e.jsx("span",{className:"text-danger-500",children:"*"})]}),e.jsx("p",{className:"text-xs text-secondary-500 mb-2",children:"Upload a screenshot or photo of your payment receipt (max 5MB)."}),e.jsx(E,{accept:"image/*",maxSize:5*1024*1024,onChange:t=>b("receipt",t[0]||null),error:_.receipt})]}),e.jsxs("div",{className:"bg-secondary-50 dark:bg-secondary-800/50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-secondary-600 dark:text-secondary-400",children:"Yearly Pro Plan"}),e.jsxs("span",{className:"text-secondary-900 dark:text-white",children:["₱",x.toLocaleString()]})]}),s?.valid&&s.discount?e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-success-600",children:"Coupon Discount"}),e.jsxs("span",{className:"text-success-600",children:["-₱",s.discount.toLocaleString()]})]}):null,e.jsxs("div",{className:"flex justify-between text-sm font-bold border-t border-secondary-200 dark:border-secondary-700 pt-2 mt-2",children:[e.jsx("span",{className:"text-secondary-900 dark:text-white",children:"Total"}),e.jsxs("span",{className:"text-accent-600",children:["₱",k.toLocaleString()]})]})]}),g?.subscription&&e.jsx("p",{className:"text-sm text-danger-600",children:g.subscription}),e.jsxs("button",{type:"submit",disabled:v||!R.receipt,className:"w-full px-4 py-3 text-sm font-semibold text-white bg-accent-500 rounded-lg hover:bg-accent-600 transition-colors disabled:opacity-50 flex items-center justify-center gap-2",children:[e.jsx(C,{className:"h-5 w-5"}),v?"Submitting...":"Submit Payment & Upgrade"]})]})]})]}):e.jsx(c,{padding:"lg",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(q,{className:"h-12 w-12 text-secondary-400 mx-auto mb-3"}),e.jsx("p",{className:"text-secondary-600 dark:text-secondary-400",children:"Subscriptions are currently not available. Please check back later."})]})})]})]})}export{de as default};
