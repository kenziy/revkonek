import{r as d,b as L,u as V,j as e,H as j,L as g}from"./app-CQdR452s.js";import{A as b}from"./AuthenticatedLayout-HhmBnaNo.js";import{C as l,B as N,P as q,F as H}from"./ProgressBar-CmNWRyn6.js";import{P as X}from"./ProBadge-sFMrbpXL.js";import{F as Z}from"./FileUpload-CHPvK9IG.js";import{F as v}from"./ArrowLeftIcon-DH5-a9EN.js";import{F as G}from"./CheckCircleIcon-CrWjMXvP.js";import{F as h}from"./SparklesIcon-B2_IIVCR.js";import{F as I}from"./ClockIcon-fa_Gy2Ss.js";import"./clsx-B-dksMZM.js";import"./transition-fQBJqPoi.js";import"./use-sync-refs-TvPC7Lcg.js";import"./ThemeToggle-C9625XrB.js";import"./Footer-C1bh1EIQ.js";import"./UserGroupIcon-CBBpCl-6.js";import"./ShieldCheckIcon-DI5QGzMO.js";import"./ExclamationTriangleIcon-Yz6WaA5o.js";import"./CheckBadgeIcon-DlBI_QHP.js";import"./PhotoIcon-vqosI-5a.js";function J({title:r,titleId:a,...t},o){return d.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":a},t),r?d.createElement("title",{id:a},r):null,d.createElement("path",{fillRule:"evenodd",d:"M19.916 4.626a.75.75 0 0 1 .208 1.04l-9 13.5a.75.75 0 0 1-1.154.114l-6-6a.75.75 0 0 1 1.06-1.06l5.353 5.353 8.493-12.74a.75.75 0 0 1 1.04-.207Z",clipRule:"evenodd"}))}const w=d.forwardRef(J);function K({title:r,titleId:a,...t},o){return d.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":a},t),r?d.createElement("title",{id:a},r):null,d.createElement("path",{fillRule:"evenodd",d:"M5.47 5.47a.75.75 0 0 1 1.06 0L12 10.94l5.47-5.47a.75.75 0 1 1 1.06 1.06L13.06 12l5.47 5.47a.75.75 0 1 1-1.06 1.06L12 13.06l-5.47 5.47a.75.75 0 0 1-1.06-1.06L10.94 12 5.47 6.53a.75.75 0 0 1 0-1.06Z",clipRule:"evenodd"}))}const D=d.forwardRef(K),Q=[{feature:"Vehicle Photos",free:"1",pro:"Up to 10"},{feature:"Bikes",free:"2",pro:"Unlimited"},{feature:"Club Memberships",free:"3",pro:"Unlimited"},{feature:"Daily Discoveries",free:"10",pro:"Unlimited"},{feature:"Daily Messages",free:"20",pro:"Unlimited"},{feature:"Photo Gallery",free:!1,pro:!0},{feature:"Layout Templates",free:!1,pro:!0},{feature:"Color Themes",free:!1,pro:!0},{feature:"Mods List",free:!1,pro:!0},{feature:"Vehicle Story",free:!1,pro:!0},{feature:"Cover Banner",free:!1,pro:!0},{feature:"Social Links",free:!1,pro:!0},{feature:"Background Music",free:!1,pro:!0},{feature:"Pro Badge",free:!1,pro:!0}];function je({plans:r,activeSubscription:a,latestSubscription:t}){const{auth:o}=L().props,k=L().props.errors,B=o?.is_premium,[c,E]=d.useState(r.length>0?r[0]:null),[m,P]=d.useState(""),[C,R]=d.useState(!1),[i,x]=d.useState(null),{data:M,setData:p,post:T,processing:_,errors:U}=V({plan_id:r.length>0?r[0].id:"",receipt:null,coupon_code:""}),$=async()=>{if(!(!m.trim()||!c)){R(!0);try{const n=await(await fetch(route("subscription.validateCoupon"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({coupon_code:m,plan_id:c.id})})).json();x(n),n.valid&&p("coupon_code",m)}catch{x({valid:!1,error:"Failed to validate coupon."})}finally{R(!1)}}},A=s=>{s.preventDefault(),T(route("subscription.store"),{forceFormData:!0})},z=s=>{E(s),p("plan_id",s.id),x(null),P(""),p("coupon_code","")},F=c?Number(c.price):0,O=i?.valid&&i.final_amount!=null?i.final_amount:F;if(B&&a&&["active","trialing"].includes(a.status)){const s=a.starts_at?new Date(a.starts_at):new Date(a.created_at),n=a.ends_at?new Date(a.ends_at):null,u=new Date,f=n?Math.ceil((n.getTime()-s.getTime())/(1e3*60*60*24)):0,y=n?Math.max(0,Math.ceil((n.getTime()-u.getTime())/(1e3*60*60*24))):0;return e.jsxs(b,{header:"Subscription",children:[e.jsx(j,{title:"Subscription"}),e.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[e.jsxs(g,{href:route("profile.edit"),className:"inline-flex items-center gap-1.5 text-sm text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300",children:[e.jsx(v,{className:"h-4 w-4"}),"Back to Profile"]}),e.jsxs(l,{padding:"lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 rounded-xl bg-amber-100 dark:bg-amber-900/30",children:e.jsx(G,{className:"h-6 w-6 text-amber-600 dark:text-amber-400"})}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-bold text-secondary-900 dark:text-white",children:[a.plan?.name??"Pro"," Plan"]}),e.jsx("p",{className:"text-sm text-secondary-500",children:"Your subscription is active"})]}),e.jsx(N,{variant:"success",size:"lg",className:"ml-auto",children:"Active"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mb-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-secondary-500 dark:text-secondary-400",children:"Started"}),e.jsx("p",{className:"font-medium text-secondary-900 dark:text-white",children:s.toLocaleDateString()})]}),n&&e.jsxs("div",{children:[e.jsx("p",{className:"text-secondary-500 dark:text-secondary-400",children:"Expires"}),e.jsx("p",{className:"font-medium text-secondary-900 dark:text-white",children:n.toLocaleDateString()})]}),a.plan&&e.jsxs("div",{children:[e.jsx("p",{className:"text-secondary-500 dark:text-secondary-400",children:"Plan"}),e.jsx("p",{className:"font-medium text-secondary-900 dark:text-white",children:a.plan.name})]}),n&&e.jsxs("div",{children:[e.jsx("p",{className:"text-secondary-500 dark:text-secondary-400",children:"Days Remaining"}),e.jsxs("p",{className:"font-medium text-secondary-900 dark:text-white",children:[y," days"]})]})]}),n&&f>0&&e.jsx(q,{value:f-y,max:f,variant:y<30?"warning":"success",showLabel:!0,label:"Subscription Progress"})]}),e.jsxs(l,{padding:"lg",children:[e.jsxs("h3",{className:"font-semibold text-secondary-900 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(h,{className:"h-5 w-5 text-amber-500"}),"Your Pro Features"]}),e.jsx(S,{})]})]})]})}if(t&&t.status==="pending_verification")return e.jsxs(b,{header:"Subscription",children:[e.jsx(j,{title:"Subscription"}),e.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[e.jsxs(g,{href:route("profile.edit"),className:"inline-flex items-center gap-1.5 text-sm text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300",children:[e.jsx(v,{className:"h-4 w-4"}),"Back to Profile"]}),e.jsxs(l,{padding:"lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 rounded-xl bg-amber-100 dark:bg-amber-900/30",children:e.jsx(I,{className:"h-6 w-6 text-amber-600 dark:text-amber-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-secondary-900 dark:text-white",children:"Under Review"}),e.jsx("p",{className:"text-sm text-secondary-500",children:"Your payment receipt is being verified"})]}),e.jsx(N,{variant:"warning",size:"lg",className:"ml-auto",children:"Pending"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mb-6",children:[t.amount&&e.jsxs("div",{children:[e.jsx("p",{className:"text-secondary-500 dark:text-secondary-400",children:"Amount"}),e.jsxs("p",{className:"font-medium text-secondary-900 dark:text-white",children:["₱",Number(t.amount).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-secondary-500 dark:text-secondary-400",children:"Submitted"}),e.jsx("p",{className:"font-medium text-secondary-900 dark:text-white",children:new Date(t.created_at).toLocaleDateString()})]}),t.plan&&e.jsxs("div",{children:[e.jsx("p",{className:"text-secondary-500 dark:text-secondary-400",children:"Plan"}),e.jsx("p",{className:"font-medium text-secondary-900 dark:text-white",children:t.plan.name})]})]}),t.receipt_path&&e.jsx("div",{className:"rounded-lg overflow-hidden bg-secondary-100 dark:bg-secondary-700",children:e.jsx("img",{src:`/storage/${t.receipt_path}`,alt:"Payment Receipt",className:"w-full max-h-[300px] object-contain"})})]})]})]});const Y=t&&t.status==="rejected";return e.jsxs(b,{header:"Subscription",children:[e.jsx(j,{title:"Subscription"}),e.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[e.jsxs(g,{href:route("profile.edit"),className:"inline-flex items-center gap-1.5 text-sm text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300",children:[e.jsx(v,{className:"h-4 w-4"}),"Back to Profile"]}),Y&&e.jsx(l,{padding:"lg",className:"border-danger-200 dark:border-danger-800",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(H,{className:"h-6 w-6 text-danger-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-danger-600 dark:text-danger-400",children:"Previous Request Rejected"}),t.admin_note&&e.jsxs("p",{className:"text-sm text-secondary-600 dark:text-secondary-400 mt-1",children:["Reason: ",t.admin_note]}),e.jsx("p",{className:"text-sm text-secondary-500 mt-2",children:"You can submit a new request below."})]})]})}),r.length>0&&e.jsx("div",{className:"space-y-4",children:r.map(s=>e.jsx(l,{padding:"lg",variant:"elevated",className:`cursor-pointer transition-all ${c?.id===s.id?"ring-2 ring-amber-500 dark:ring-amber-400":"hover:ring-1 hover:ring-secondary-300 dark:hover:ring-secondary-600"}`,onClick:()=>z(s),children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[e.jsx(h,{className:"h-6 w-6 text-amber-500"}),e.jsx("h2",{className:"text-xl font-bold text-secondary-900 dark:text-white",children:s.name}),e.jsx(X,{size:"sm"})]}),s.description&&e.jsx("p",{className:"text-sm text-secondary-500 dark:text-secondary-400 mt-1",children:s.description}),e.jsxs("div",{className:"flex items-baseline justify-center gap-1 mt-4",children:[e.jsxs("span",{className:"text-3xl font-bold text-amber-600 dark:text-amber-400",children:[s.currency==="PHP"?"₱":s.currency,Number(s.price).toLocaleString()]}),e.jsxs("span",{className:"text-secondary-500",children:["/ ",s.billing_period]})]}),s.features&&s.features.length>0&&e.jsx("ul",{className:"mt-4 space-y-2 text-left",children:s.features.map((n,u)=>e.jsxs("li",{className:"flex items-center gap-2 text-sm text-secondary-700 dark:text-secondary-300",children:[e.jsx(w,{className:"h-4 w-4 text-amber-500 flex-shrink-0"}),n]},u))}),c?.id===s.id&&e.jsx("div",{className:"mt-3",children:e.jsx(N,{variant:"warning",size:"sm",children:"Selected"})})]})},s.id))}),e.jsxs(l,{padding:"lg",children:[e.jsxs("h3",{className:"font-semibold text-secondary-900 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(h,{className:"h-5 w-5 text-amber-500"}),"Feature Comparison"]}),e.jsx(S,{})]}),c&&e.jsxs(l,{padding:"lg",children:[e.jsx("h3",{className:"font-semibold text-secondary-900 dark:text-white mb-4",children:"Submit Payment"}),e.jsxs("form",{onSubmit:A,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-1",children:"Coupon Code (optional)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:m,onChange:s=>{P(s.target.value.toUpperCase()),x(null)},className:"flex-1 rounded-lg border border-secondary-300 dark:border-secondary-600 bg-white dark:bg-secondary-700 text-secondary-900 dark:text-white text-sm px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 font-mono",placeholder:"Enter coupon code"}),e.jsx("button",{type:"button",onClick:$,disabled:C||!m.trim(),className:"px-4 py-2 text-sm font-medium text-primary-600 bg-primary-50 rounded-lg hover:bg-primary-100 dark:bg-primary-900/20 dark:text-primary-400 transition-colors disabled:opacity-50",children:C?"Checking...":"Apply"})]}),i&&e.jsx("p",{className:`text-sm mt-1 ${i.valid?"text-success-600":"text-danger-600"}`,children:i.valid?`Discount applied! You save ₱${i.discount?.toLocaleString()}`:i.error})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-secondary-700 dark:text-secondary-300 mb-1",children:["Payment Receipt ",e.jsx("span",{className:"text-danger-500",children:"*"})]}),e.jsx("p",{className:"text-xs text-secondary-500 mb-2",children:"Upload a screenshot or photo of your payment receipt (max 5MB)."}),e.jsx(Z,{accept:"image/*",maxSize:5*1024*1024,onChange:s=>p("receipt",s[0]||null),error:U.receipt})]}),e.jsxs("div",{className:"bg-secondary-50 dark:bg-secondary-800/50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsxs("span",{className:"text-secondary-600 dark:text-secondary-400",children:[c.name," (",c.billing_period,")"]}),e.jsxs("span",{className:"text-secondary-900 dark:text-white",children:["₱",F.toLocaleString()]})]}),i?.valid&&i.discount?e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-success-600",children:"Coupon Discount"}),e.jsxs("span",{className:"text-success-600",children:["-₱",i.discount.toLocaleString()]})]}):null,e.jsxs("div",{className:"flex justify-between text-sm font-bold border-t border-secondary-200 dark:border-secondary-700 pt-2 mt-2",children:[e.jsx("span",{className:"text-secondary-900 dark:text-white",children:"Total"}),e.jsxs("span",{className:"text-amber-600",children:["₱",O.toLocaleString()]})]})]}),k?.subscription&&e.jsx("p",{className:"text-sm text-danger-600",children:k.subscription}),e.jsxs("button",{type:"submit",disabled:_||!M.receipt,className:"w-full px-4 py-3 text-sm font-semibold text-white bg-gradient-to-r from-amber-400 to-orange-500 rounded-lg hover:from-amber-500 hover:to-orange-600 transition-colors disabled:opacity-50 flex items-center justify-center gap-2",children:[e.jsx(h,{className:"h-5 w-5"}),_?"Submitting...":"Submit Payment & Upgrade"]})]})]})]})]})}function S(){return e.jsxs("div",{className:"border rounded-lg overflow-hidden divide-y divide-secondary-100 dark:divide-secondary-700 border-secondary-200 dark:border-secondary-700",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 px-4 py-2 bg-secondary-50 dark:bg-secondary-800/50 text-xs font-medium text-secondary-500 uppercase",children:[e.jsx("span",{children:"Feature"}),e.jsx("span",{className:"text-center",children:"Free"}),e.jsx("span",{className:"text-center",children:"Pro"})]}),Q.map(({feature:r,free:a,pro:t})=>e.jsxs("div",{className:"grid grid-cols-3 gap-4 px-4 py-2.5 text-sm",children:[e.jsx("span",{className:"text-secondary-700 dark:text-secondary-300",children:r}),e.jsx("span",{className:"text-center text-secondary-500",children:typeof a=="boolean"?a?e.jsx(w,{className:"h-4 w-4 text-success-500 inline"}):e.jsx(D,{className:"h-4 w-4 text-secondary-300 dark:text-secondary-600 inline"}):a}),e.jsx("span",{className:"text-center text-amber-600 font-medium",children:typeof t=="boolean"?t?e.jsx(w,{className:"h-4 w-4 text-amber-500 inline"}):e.jsx(D,{className:"h-4 w-4 text-secondary-300 dark:text-secondary-600 inline"}):t})]},r))]})}export{je as default};
