import{r as h,j as e,H as C,L as A,a as p}from"./app-CQdR452s.js";import{A as $}from"./AuthenticatedLayout-HhmBnaNo.js";import{C as n,B as c,A as u}from"./ProgressBar-CmNWRyn6.js";import{c as g}from"./clsx-B-dksMZM.js";import{F as z}from"./ArrowLeftIcon-DH5-a9EN.js";import{F as G}from"./CalendarDaysIcon-D42YAsvN.js";import{F as L}from"./ClockIcon-fa_Gy2Ss.js";import{F as B}from"./MapPinIcon-aMovNZRX.js";import{F as D}from"./LinkIcon-BKf-SMfB.js";import{F as E}from"./UserGroupIcon-CBBpCl-6.js";import{F as M}from"./CheckCircleIcon-CrWjMXvP.js";import{F as T}from"./CheckCircleIcon-ZW0BS5EI.js";import"./transition-fQBJqPoi.js";import"./use-sync-refs-TvPC7Lcg.js";import"./ThemeToggle-C9625XrB.js";import"./Footer-C1bh1EIQ.js";import"./ShieldCheckIcon-DI5QGzMO.js";import"./ExclamationTriangleIcon-Yz6WaA5o.js";function re({club:l,event:a,userRsvp:f,attendance:j,clubMembers:y,canManage:b,isPastEvent:w}){const[i,N]=h.useState(j),[o,m]=h.useState(!1),k=[{value:"going",label:"Going",color:"bg-success-600"},{value:"maybe",label:"Maybe",color:"bg-warning-600"},{value:"not_going",label:"Can't Go",color:"bg-secondary-400"}],_=s=>{p.post(route("clubs.events.rsvp",[l.slug,a.id]),{status:s})},v=s=>{switch(s){case"ride":return"primary";case"meetup":return"success";case"track_day":return"warning";case"workshop":return"info";default:return"secondary"}},F=s=>{N(t=>t.includes(s)?t.filter(r=>r!==s):[...t,s])},R=()=>{m(!0),p.post(route("clubs.events.attendance",[l.slug,a.id]),{user_ids:i},{onFinish:()=>m(!1)})},d=new Set(a.rsvps?.filter(s=>s.status==="going").map(s=>s.user_id)??[]),x=[...y].sort((s,t)=>{const r=d.has(s.user_id)?0:1,S=d.has(t.user_id)?0:1;return r-S});return e.jsxs($,{children:[e.jsx(C,{title:a.title}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(A,{href:route("clubs.events",l.slug),className:"inline-flex items-center gap-1.5 text-sm text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300",children:[e.jsx(z,{className:"h-4 w-4"}),"Back to Events"]}),e.jsxs(n,{padding:"lg",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap mb-2",children:[e.jsx(c,{variant:v(a.type),size:"sm",children:a.type.replace("_"," ")}),a.is_cancelled&&e.jsx(c,{variant:"danger",size:"sm",children:"Cancelled"})]}),e.jsx("h1",{className:"text-xl font-bold text-secondary-900 dark:text-white",children:a.title}),a.description&&e.jsx("p",{className:"text-secondary-600 dark:text-secondary-400 mt-2 whitespace-pre-wrap",children:a.description}),e.jsxs("div",{className:"mt-4 space-y-2 text-sm text-secondary-500 dark:text-secondary-400",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-5 w-5"}),e.jsx("span",{children:new Date(a.starts_at).toLocaleDateString("en",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-5 w-5"}),e.jsxs("span",{children:[new Date(a.starts_at).toLocaleTimeString("en",{hour:"2-digit",minute:"2-digit"}),a.ends_at&&` â€” ${new Date(a.ends_at).toLocaleTimeString("en",{hour:"2-digit",minute:"2-digit"})}`]})]}),a.location_name&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-5 w-5"}),e.jsx("span",{children:a.location_name})]}),a.route_link&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{className:"h-5 w-5"}),e.jsx("a",{href:a.route_link,target:"_blank",rel:"noopener noreferrer",className:"text-primary-600 dark:text-primary-400 hover:underline",children:"View Route"})]}),a.max_attendees&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"h-5 w-5"}),e.jsxs("span",{children:[a.rsvps?.filter(s=>s.status==="going").length??0," / ",a.max_attendees," spots"]})]})]}),a.creator&&e.jsxs("p",{className:"text-xs text-secondary-400 mt-3",children:["Created by ",a.creator.display_name]})]}),!a.is_cancelled&&e.jsxs(n,{padding:"lg",children:[e.jsx("h3",{className:"font-semibold text-secondary-900 dark:text-white mb-3",children:"RSVP"}),e.jsx("div",{className:"flex gap-2",children:k.map(s=>e.jsx("button",{onClick:()=>_(s.value),className:g("flex-1 py-2.5 rounded-lg font-semibold text-sm transition-all",f?.status===s.value?`${s.color} text-white`:"bg-secondary-100 dark:bg-secondary-800 text-secondary-600 dark:text-secondary-400 hover:bg-secondary-200 dark:hover:bg-secondary-700"),children:s.label},s.value))})]}),a.rsvps&&a.rsvps.length>0&&e.jsxs(n,{children:[e.jsxs("h3",{className:"font-semibold text-secondary-900 dark:text-white mb-3",children:["Attendees (",a.rsvps.filter(s=>s.status==="going").length,")"]}),e.jsx("div",{className:"space-y-2",children:a.rsvps.filter(s=>s.status==="going").map(s=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(u,{name:s.user?.display_name,size:"sm"}),e.jsx("span",{className:"text-sm text-secondary-900 dark:text-white",children:s.user?.display_name})]},s.id))})]}),b&&w&&!a.is_cancelled&&e.jsxs(n,{padding:"lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"font-semibold text-secondary-900 dark:text-white flex items-center gap-2",children:[e.jsx(M,{className:"h-5 w-5 text-success-500"}),"Mark Attendance"]}),e.jsx(c,{variant:"success",size:"sm",children:"10 pts each"})]}),x.length>0?e.jsx("div",{className:"space-y-1 max-h-80 overflow-y-auto",children:x.map(s=>{const t=i.includes(s.user_id),r=d.has(s.user_id);return e.jsxs("button",{type:"button",onClick:()=>F(s.user_id),className:g("w-full flex items-center gap-3 px-3 py-2.5 rounded-xl transition-colors text-left",t?"bg-success-50 dark:bg-success-900/20":"hover:bg-secondary-50 dark:hover:bg-secondary-800"),children:[t?e.jsx(T,{className:"h-5 w-5 text-success-500 flex-shrink-0"}):e.jsx("div",{className:"h-5 w-5 rounded-full border-2 border-secondary-300 dark:border-secondary-600 flex-shrink-0"}),e.jsx(u,{src:s.user?.avatar,name:s.user?.display_name,size:"sm"}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("p",{className:"text-sm font-medium text-secondary-900 dark:text-white truncate",children:s.user?.display_name})}),r&&e.jsx(c,{variant:"success",size:"sm",children:"RSVP'd"})]},s.id)})}):e.jsx("p",{className:"text-sm text-secondary-400",children:"No club members found."}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsxs("p",{className:"text-xs text-secondary-400",children:[i.length," member",i.length!==1?"s":""," attended"]}),e.jsx("button",{onClick:R,disabled:o,className:"px-5 py-2 bg-success-600 hover:bg-success-500 disabled:opacity-50 text-white rounded-xl font-semibold text-sm transition-colors",children:o?"Saving...":"Save Attendance"})]})]})]})]})}export{re as default};
